<div class="groups-container">
    
    <p-toast position="top-right"></p-toast>
    <p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>

    <header class="page-header">
        <div class="header-content">
            <div>
                <h1>Gestión de Grupos</h1>
                <p>Administra las categorías y equipos.</p>
            </div>
        </div>
        <button pButton label="Nuevo Grupo" icon="pi pi-plus" class="btn-create" (click)="abrirNuevo()"></button>
    </header>

    <div class="card-table table-responsive">
        <p-table [value]="grupos" [loading]="loading" [rows]="10" [paginator]="true" styleClass="p-datatable-sm">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 30%">Nombre</th>
                    <th style="width: 20%" class="text-center">Alumnos</th> 
                    <th style="width: 30%" class="hidden-mobile">Descripción</th>
                    <th style="width: 20%" class="text-center">Acciones</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-grupo>
                <tr>
                    <td>
                        <span class="font-bold text-lg">{{ grupo.nombre }}</span>
                        <div class="mobile-desc visible-mobile" *ngIf="grupo.descripcion">{{ grupo.descripcion }}</div>
                    </td>
                    
                    <td class="text-center">
                        <p-tag [value]="grupo.cantidad_alumnos" 
                               [severity]="grupo.cantidad_alumnos > 0 ? 'info' : 'secondary'"
                               [rounded]="true">
                        </p-tag>
                    </td>

                    <td class="hidden-mobile text-secondary">{{ grupo.descripcion || 'Sin descripción' }}</td>
                    
                    <td class="text-center">
                        <div class="action-buttons">
                            <button pButton icon="pi pi-pencil" class="p-button-text p-button-warning p-button-rounded" (click)="abrirEditar(grupo)"></button>
                            <button pButton icon="pi pi-trash" class="p-button-text p-button-danger p-button-rounded" (click)="eliminarGrupo(grupo.id)"></button>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="4" class="text-center p-4 text-secondary">
                        <i class="pi pi-folder-open block mb-2" style="font-size: 2rem"></i>
                        No hay grupos creados aún.
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <p-dialog [(visible)]="displayDialog" [header]="tituloDialogo" [modal]="true" [style]="{width: '90vw', maxWidth: '450px'}" styleClass="p-fluid">
        <ng-template pTemplate="content">
            <div class="flex flex-column pt-2">
                <div class="field">
                    <label>Nombre del Grupo <span class="text-red-500 font-bold">*</span></label>
                    <input pInputText [(ngModel)]="grupoForm.nombre" placeholder="Ej: Sub-17 A" />
                </div>
                <div class="field">
                    <label>Descripción</label>
                    <textarea pTextarea [(ngModel)]="grupoForm.descripcion" rows="4" placeholder="Detalles opcionales..."></textarea>
                </div>
            </div>
        </ng-template>
        <ng-template pTemplate="footer">
            <button pButton label="Cancelar" icon="pi pi-times" class="p-button-text" (click)="displayDialog = false"></button>
            <button pButton label="Guardar" icon="pi pi-check" (click)="guardarGrupo()"></button>
        </ng-template>
    </p-dialog>

</div>